(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{357:function(e,t,r){"use strict";r.r(t);r(5);var n,o,c=r(0),h=(r(73),r(107)),d=r(74),l=d.helpers.regex("alpha",/^((\+7|7|8)+(\()+([0-9]){3})+(\))+([0-9]{3})+(-)+([0-9]{2})+(-)+([0-9]{2})$/),f={name:"ResetPasswordPage",mixins:[h.validationMixin],validations:{phone:{required:d.required,phoneAlpha:l},code:{required:d.required}},data:function(){return{phone:"",code:"",isCode:!1}},computed:{phoneErrors:function(){var e=[];return this.$v.phone.$dirty?(!this.$v.phone.required&&e.push("Обязательное поле!"),!this.$v.phone.phoneAlpha&&e.push("Номер телефона не валиден! +7(___)___-__-__"),e):e},codeErrors:function(){var e=[];return this.$v.code.$dirty?(!this.$v.code.required&&e.push("Обязательное поле!"),e):e}},methods:{filterPhone:function(){return this.phone.replace(/[^0-9]/g,"")},getCode:(o=Object(c.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.$v.$touch(),!this.$v.phone.$error){e.next=3;break}return e.abrupt("return");case 3:return this.filterPhone(),e.next=6,this.$store.dispatch("auth/resetPassword",{phone:this.filterPhone()});case 6:(t=e.sent).id?this.isCode=!0:404===t?this.$store.dispatch("fetchNotification",{isActive:!0,type:"error",message:"Пользователь с таким номером не найден"}):this.$store.dispatch("fetchNotification",{isActive:!0,type:"error",message:"Произошла ошибка при восстановлении пароля"});case 8:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)}),login:(n=Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.$v.$touch(),!this.$v.$error){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.$store.dispatch("auth/login",{phone:this.filterPhone(),password:this.code});case 5:e.sent.access_token?this.$router.push("/profile"):this.$store.dispatch("fetchNotification",{isActive:!0,type:"error",message:"Неверный логин или пароль"});case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},beforeRouteLeave:function(e,t,r){this.$store.dispatch("fetchMenu",!1),this.$store.dispatch("fetchCityModal",!1),this.$store.dispatch("fetchCallbackModal",!1),r()}},v=r(3),component=Object(v.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("main",[r("section",{staticClass:"section section--full-screen d-flex f-column align-center justify-center"},[e._m(0),r("div",{staticClass:"container d-flex align-center justify-center"},[r("form",{staticClass:"form form--auth"},[r("div",{staticClass:"form--card"},[r("div",{staticClass:"form--card-inner"},[r("m-input",{class:{"input--error":e.phoneErrors.length>0},attrs:{inputId:"phone",placeholder:"+7(___)___-__-__",value:e.phone,required:!0,footerText:e.phoneErrors[0],mask:"+#(###)###-##-##",disabled:e.isCode},on:{input:function(t){e.phone=t,e.$v.phone.$touch()},blur:function(t){return e.$v.phone.$touch()}}}),e.isCode?r("m-input",{class:{"input--error":e.codeErrors.length>0},attrs:{inputId:"code",placeholder:"Код из смс",value:e.code,footerText:e.codeErrors[0],type:"password"},on:{input:function(t){e.code=t},blur:function(t){return e.$v.code.$touch()}}}):e._e(),e.isCode?e._e():r("div",{staticClass:"button button_brand",on:{click:e.getCode}},[r("div",{staticClass:"button--text"},[e._v("Выслать код")])]),e.isCode?r("div",{staticClass:"button button_brand",on:{click:e.login}},[r("div",{staticClass:"button--text"},[e._v("Продолжить")])]):e._e()],1)])])])])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"container"},[t("h1",{staticClass:"section--title text--center"},[this._v("Восстановление пароля")])])}],!1,null,null,null);t.default=component.exports}}]);