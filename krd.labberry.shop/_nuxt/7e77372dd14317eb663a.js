(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{331:function(t,e,r){"use strict";var n={name:"MProfileNav",data:function(){return{items:[{title:"Личные данные",link:"/profile"},{title:"Мои заказы",link:"/profile/history"},{title:"Бонусы и скидки",link:"/profile/bonus"}]}}},d=r(3),component=Object(d.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"section section--first"},[r("div",{staticClass:"container"},[r("div",{staticClass:"section--nav"},t._l(t.items,(function(e,i){return r("nuxt-link",{key:i,staticClass:"section--nav-link",attrs:{to:e.link}},[t._v(t._s(e.title))])})),1)])])}),[],!1,null,null,null);e.a=component.exports},345:function(t,e,r){"use strict";r.r(e);r(40),r(22),r(19),r(33);var n=r(20),d=(r(108),r(109),r(16),r(5),r(0)),o=r(107),c=r(74),l=r(331),h=r(155);(new Date).setHours(0,0,0,0);var f={name:"MInputComponent",components:{DatePicker:h.a},props:{inputId:{type:String,default:""},name:{type:String,default:""},placeholder:{type:String,default:""},required:{type:Boolean,default:!1},footerText:{type:String,default:""},date:{type:String,default:""}},data:function(){return{value:null}},mounted:function(){this.value=this.date},updated:function(){this.value=this.date},methods:{change:function(t){null===t?this.$emit("change",""):this.$emit("change","".concat(t))}}},v=r(3),m=Object(v.a)(f,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"input--wrapper input--date-picker"},[r("date-picker",{attrs:{placeholder:t.placeholder,format:"MM/DD",type:"date","value-type":"format",value:""+t.date},on:{change:function(e){return t.change(e)}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),t.footerText?r("div",{staticClass:"input--footer",domProps:{innerHTML:t._s(t.footerText)}}):t._e()],1)}),[],!1,null,null,null).exports;function $(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function k(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?$(source,!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):$(source).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var x,y,C,D={name:"ProfileBonusPage",components:{mProfileNav:l.a,mDatepickerImportantDates:m},mixins:[o.validationMixin],validations:{dates:{firstdate:{required:c.required},seconddate:{required:c.required},thirddate:{required:c.required},firstdatetitle:{required:c.required},seconddatetitle:{required:c.required},thirddatetitle:{required:c.required}}},data:function(){return{firstdate:"",seconddate:"",thirddate:"",isDates:!1}},computed:{dates:function(){return this.$store.getters["importantdates/getDates"]},bonus:function(){return this.$store.getters["bonus/getBonus"]},firstdateErrors:function(){var t=[];return this.$v.dates.firstdate.$dirty?(!this.$v.dates.firstdate.required&&t.push("Обязательное поле!"),t):t},seconddateErrors:function(){var t=[];return this.$v.dates.seconddate.$dirty?(!this.$v.dates.seconddate.required&&t.push("Обязательное поле!"),t):t},thirddateErrors:function(){var t=[];return this.$v.dates.thirddate.$dirty?(!this.$v.dates.thirddate.required&&t.push("Обязательное поле!"),t):t},firstdatetitleErrors:function(){var t=[];return this.$v.dates.firstdatetitle.$dirty?(!this.$v.dates.firstdatetitle.required&&t.push("Обязательное поле!"),t):t},seconddatetitleErrors:function(){var t=[];return this.$v.dates.seconddatetitle.$dirty?(!this.$v.dates.seconddatetitle.required&&t.push("Обязательное поле!"),t):t},thirddatetitleErrors:function(){var t=[];return this.$v.dates.thirddatetitle.$dirty?(!this.$v.dates.thirddatetitle.required&&t.push("Обязательное поле!"),t):t}},mounted:(C=Object(d.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.$store.dispatch("fetchGiftModal",!1),!localStorage.getItem("access_token")){t.next=4;break}return t.next=4,this.$store.dispatch("profile/fetchProfile");case 4:case"end":return t.stop()}}),t,this)}))),function(){return C.apply(this,arguments)}),methods:{transformDateToDateFormat:function(){var t=(new Date).getFullYear();this.firstdate=new Date("".concat(t,"/").concat(this.dates.firstdate)),this.seconddate=new Date("".concat(t,"/").concat(this.dates.seconddate)),this.thirddate=new Date("".concat(t,"/").concat(this.dates.thirddate))},datesValid:function(){return"Invalid Date"!==this.firstdate.toString()&&"Invalid Date"!==this.seconddate.toString()&&"Invalid Date"!==this.thirddate.toString()},create:(y=Object(d.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.$v.$touch(),this.transformDateToDateFormat(),this.datesValid()){t.next=5;break}return this.$store.dispatch("fetchNotification",{isActive:!0,type:"error",message:"Не верный формат данных"}),t.abrupt("return");case 5:if(!this.$v.$error){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,this.$store.dispatch("importantdates/createDates",{dates:k({},this.dates,{firstdate:this.firstdate,seconddate:this.seconddate,thirddate:this.thirddate})});case 9:return t.next=11,this.$store.dispatch("onetimegift/fetchOnetimegift");case 11:case"end":return t.stop()}}),t,this)}))),function(){return y.apply(this,arguments)}),update:(x=Object(d.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.$v.$touch(),this.transformDateToDateFormat(),this.datesValid()){t.next=5;break}return this.$store.dispatch("fetchNotification",{isActive:!0,type:"error",message:"Не верный формат данных"}),t.abrupt("return");case 5:if(!this.$v.$error){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,this.$store.dispatch("importantdates/updateDates",{dates:k({},this.dates,{firstdate:this.firstdate,seconddate:this.seconddate,thirddate:this.thirddate})});case 9:return t.next=11,this.$store.dispatch("onetimegift/fetchOnetimegift");case 11:case"end":return t.stop()}}),t,this)}))),function(){return x.apply(this,arguments)})},beforeRouteLeave:function(t,e,r){this.$store.dispatch("fetchMenu",!1),this.$store.dispatch("fetchCityModal",!1),this.$store.dispatch("fetchCallbackModal",!1),r()}},w=Object(v.a)(D,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("main",[r("m-profile-nav"),r("section",{staticClass:"section"},[r("div",{staticClass:"container"},[r("div",{staticClass:"section--blocks grid grid--xl-2 grid--md-1"},[r("div",{staticClass:"section--block"},[r("h2",{staticClass:"section--title"},[t._v("Ваши бонусы")]),r("h2",{staticClass:"section--title"},[t._v(t._s(t.bonus.count))]),r("p",[t._v("Бонусы начисляются в размере 5% от каждой покупки")])]),r("div",{staticClass:"section--block-divider"}),!t.dates.id||t.isDates?r("div",{staticClass:"section--block important-date"},[r("div",{staticClass:"section--title"},[t._v("Важные даты")]),r("p",[t._v("Выберите три важные даты своих близких и получите подарок!")]),r("p",[t._v("Это могут быть как дни рождения или годовщины, так и просто напоминания в праздники.")]),r("div",{staticClass:"input--wrap"},[r("m-input",{class:{"input--error":t.firstdatetitleErrors.length>0},attrs:{placeholder:"Событие",footerText:t.firstdatetitleErrors[0]},on:{input:function(e){return t.$v.dates.firstdatetitle.$touch()},blur:function(e){return t.$v.dates.firstdatetitle.$touch()}},model:{value:t.dates.firstdatetitle,callback:function(e){t.$set(t.dates,"firstdatetitle",e)},expression:"dates.firstdatetitle"}})],1),r("div",{staticClass:"input--wrap"},[r("m-datepicker-important-dates",{class:{"input--error":t.firstdateErrors.length>0},attrs:{placeholder:"Выберите дату",date:t.dates.firstdate},on:{change:function(e){t.dates.firstdate=e,t.$v.dates.firstdate.$touch()},blur:function(e){return t.$v.dates.firstdate.$touch()}}})],1),r("div",{staticClass:"input--wrap"},[r("m-input",{class:{"input--error":t.seconddatetitleErrors.length>0},attrs:{placeholder:"Событие",footerText:t.seconddatetitleErrors[0]},on:{input:function(e){return t.$v.dates.seconddatetitle.$touch()},blur:function(e){return t.$v.dates.seconddatetitle.$touch()}},model:{value:t.dates.seconddatetitle,callback:function(e){t.$set(t.dates,"seconddatetitle",e)},expression:"dates.seconddatetitle"}})],1),r("div",{staticClass:"input--wrap"},[r("m-datepicker-important-dates",{class:{"input--error":t.seconddateErrors.length>0},attrs:{placeholder:"Выберите дату",date:t.dates.seconddate},on:{change:function(e){t.dates.seconddate=e,t.$v.dates.seconddate.$touch()},blur:function(e){return t.$v.dates.seconddate.$touch()}}})],1),r("div",{staticClass:"input--wrap"},[r("m-input",{class:{"input--error":t.thirddatetitleErrors.length>0},attrs:{placeholder:"Событие",footerText:t.thirddatetitleErrors[0]},on:{input:function(e){return t.$v.dates.thirddatetitle.$touch()},blur:function(e){return t.$v.dates.thirddatetitle.$touch()}},model:{value:t.dates.thirddatetitle,callback:function(e){t.$set(t.dates,"thirddatetitle",e)},expression:"dates.thirddatetitle"}})],1),r("div",{staticClass:"input--wrap"},[r("m-datepicker-important-dates",{class:{"input--error":t.thirddateErrors.length>0},attrs:{placeholder:"Выберите дату",date:t.dates.thirddate},on:{change:function(e){t.dates.thirddate=e,t.$v.dates.thirddate.$touch()},blur:function(e){return t.$v.dates.thirddate.$touch()}}})],1),void 0===t.dates.id||null===t.dates.id||""===t.dates.id?r("button",{staticClass:"button",on:{click:t.create}},[r("div",{staticClass:"button--text"},[t._v("Создать")])]):t._e(),void 0!==t.dates.id&&null!==t.dates.id&&""!==t.dates.id?r("button",{staticClass:"button",on:{click:t.update}},[r("div",{staticClass:"button--text"},[t._v("Сохранить")])]):t._e()]):t._e(),t.dates.id&&!t.isDates?r("div",{staticClass:"section--block important-date"},[r("div",{staticClass:"section--title"},[t._v("Важные даты")]),r("p",[t._v("Вы ввели важные даты и получите подарок при первом заказе")]),r("button",{staticClass:"button",on:{click:function(e){t.isDates=!t.isDates}}},[r("div",{staticClass:"button--text"},[t._v("Изменить")])])]):t._e()])])])],1)}),[],!1,null,null,null);e.default=w.exports}}]);